[build]
builder = "NIXPACKS"

[deploy]
startCommand = "cd backend && npm install && node dist/server.js"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

[healthcheck]
path = "/health"
interval = 30
timeout = 5
unhealthy_threshold = 3
healthy_threshold = 2

[environments.production]
NODE_ENV = "production"
PORT = "3001"

[build.nixpacks]
buildCommand = "cd backend && npm install"